{"version":3,"sources":["webpack:///node_modules/web3-provider-engine/util/stoplight.js","webpack:///node_modules/web3-provider-engine/subproviders/subscriptions.js","webpack:///node_modules/web3-provider-engine/subproviders/hooked-wallet.js","webpack:///node_modules/web3-provider-engine/subproviders/subprovider.js","webpack:///node_modules/web3-provider-engine/util/estimate-gas.js","webpack:///node_modules/web3-provider-engine/subproviders/filters.js","webpack:///node_modules/web3-provider-engine/index.js","webpack:///node_modules/web3-provider-engine/util/rpc-cache-utils.js","webpack:///node_modules/web3-provider-engine/subproviders/json-rpc-engine-middleware.js","webpack:///node_modules/web3-provider-engine/util/random-id.js","webpack:///node_modules/web3-provider-engine/util/create-payload.js"],"names":["EventEmitter","inherits","module","exports","Stoplight","self","call","isLocked","prototype","go","emit","stop","fn","once","setTimeout","ProviderSubprovider","createSubscriptionManager","SubscriptionsSubprovider","blockTracker","provider","engine","events","middleware","on","data","waterfall","parallel","ethUtil","sigUtil","extend","Semaphore","Subprovider","estimateGas","hexRegex","HookedWalletSubprovider","opts","nonceLock","getAccounts","processTransaction","processMessage","processPersonalMessage","processTypedMessage","approveTransaction","autoApprove","approveMessage","approvePersonalMessage","approveDecryptMessage","approveEncryptionPublicKey","approveTypedMessage","signTransaction","mustProvideInConstructor","signMessage","signPersonalMessage","decryptMessage","encryptionPublicKey","signTypedMessage","recoverPersonalSignature","publishTransaction","getGasPrice","handleRequest","payload","next","end","_parityRequests","_parityRequestCount","txParams","msgParams","extraParams","message","address","method","err","accounts","result","params","cb","validateTransaction","processSignTransaction","from","validateMessage","first","second","resemblesData","resemblesAddress","warning","console","warn","validatePersonalMessage","validateDecryptMessage","processDecryptMessage","validateEncryptionPublicKey","processEncryptionPublicKey","signature","sig","validateTypedMessage","parityPostTransaction","parityPostSign","requestId","parityCheckRequest","account","didApprove","checkApproval","finalizeAndSubmitTx","finalizeTx","type","Error","count","reqId","toString","emitPayload","error","res","txHash","senderHex","undefined","validateSender","senderIsValid","isValidHex","senderAddress","map","toLowerCase","indexOf","take","fillInTxExtras","bind","leave","signedTx","raw","tx","rawTx","tasks","gasPrice","nonce","gas","cloneTxParams","taskResults","to","value","string","fixed","addHexPrefix","isValid","isValidAddress","isString","isHexPrefixed","slice","nonPrefixed","match","methodName","createPayload","SubProvider","setEngine","block","currentBlock","start","sendAsync","createFilterMiddleware","EthBlockTracker","eachSeries","cacheUtils","noop","Web3ProviderEngine","setMaxListeners","directProvider","_handleAsync","blockTrackerProvider","_blockTracker","pollingInterval","setSkipCacheFlag","_ready","_providers","blockNumber","_getBlockByNumberWithRetry","log","bufferBlock","toBufferBlock","_setCurrentBlock","_running","removeAllListeners","isRunning","addProvider","source","index","splice","push","removeProvider","send","Array","isArray","retriesRemaining","attemptRequest","_getBlockByNumber","afterRequest","req","skipCache","finished","currentProvider","stack","after","unshift","length","e","_error","_result","callback","resultObj","id","jsonrpc","code","jsonBlock","number","toBuffer","hash","parentHash","mixHash","sha3Uncles","logsBloom","transactionsRoot","stateRoot","receiptsRoot","receiptRoot","miner","difficulty","totalDifficulty","size","extraData","gasLimit","gasUsed","timestamp","transactions","stringify","cacheIdentifierForPayload","canCache","blockTagForPayload","paramsWithoutBlockTag","blockTagParamIndex","cacheTypeForPayload","includeBlockRef","JsonRpcEngineMiddlewareSubprovider","constructorFn","_constructorFn","provEngNext","provEngEnd","middlewareNext","middlewareEnd","handler","createRandomId","Math","floor","Number","MAX_SAFE_INTEGER","random","getRandomId"],"mappings":"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","file":"default~providerEngine-8b8d4e67-js~walletconnect-web3-provider-es5.js","sourcesContent":["const EventEmitter = require('events').EventEmitter\nconst inherits = require('util').inherits\n\nmodule.exports = Stoplight\n\n\ninherits(Stoplight, EventEmitter)\n\nfunction Stoplight(){\n  const self = this\n  EventEmitter.call(self)\n  self.isLocked = true\n}\n\nStoplight.prototype.go = function(){\n  const self = this\n  self.isLocked = false\n  self.emit('unlock')\n}\n\nStoplight.prototype.stop = function(){\n  const self = this\n  self.isLocked = true\n  self.emit('lock')\n}\n\nStoplight.prototype.await = function(fn){\n  const self = this\n  if (self.isLocked) {\n    self.once('unlock', fn)\n  } else {\n    setTimeout(fn)\n  }\n}","const ProviderSubprovider = require('./json-rpc-engine-middleware')\nconst createSubscriptionManager = require('eth-json-rpc-filters/subscriptionManager')\n\nclass SubscriptionsSubprovider extends ProviderSubprovider {\n  constructor() {\n    super(({ blockTracker, provider, engine }) => {\n      const { events, middleware } = createSubscriptionManager({ blockTracker, provider })\n      // forward subscription events on the engine\n      events.on('notification', (data) => engine.emit('data', null, data))\n      // return the subscription install/remove middleware\n      return middleware\n    })\n  }\n}\n\nmodule.exports = SubscriptionsSubprovider\n","/*\n * Emulate 'eth_accounts' / 'eth_sendTransaction' using 'eth_sendRawTransaction'\n *\n * The two callbacks a user needs to implement are:\n * - getAccounts() -- array of addresses supported\n * - signTransaction(tx) -- sign a raw transaction object\n */\n\nconst waterfall = require('async/waterfall')\nconst parallel = require('async/parallel')\nconst inherits = require('util').inherits\nconst ethUtil = require('ethereumjs-util')\nconst sigUtil = require('eth-sig-util')\nconst extend = require('xtend')\nconst Semaphore = require('semaphore')\nconst Subprovider = require('./subprovider.js')\nconst estimateGas = require('../util/estimate-gas.js')\nconst hexRegex = /^[0-9A-Fa-f]+$/g\n\nmodule.exports = HookedWalletSubprovider\n\n// handles the following RPC methods:\n//   eth_coinbase\n//   eth_accounts\n//   eth_sendTransaction\n//   eth_sign\n//   eth_signTypedData\n//   eth_signTypedData_v3\n//   eth_signTypedData_v4\n//   personal_sign\n//   eth_decryptMessage\n//   encryption_public_key\n//   personal_ecRecover\n//   parity_postTransaction\n//   parity_checkRequest\n//   parity_defaultAccount\n\n//\n// Tx Signature Flow\n//\n// handleRequest: eth_sendTransaction\n//   validateTransaction (basic validity check)\n//     validateSender (checks that sender is in accounts)\n//   processTransaction (sign tx and submit to network)\n//     approveTransaction (UI approval hook)\n//     checkApproval\n//     finalizeAndSubmitTx (tx signing)\n//       nonceLock.take (bottle neck to ensure atomic nonce)\n//         fillInTxExtras (set fallback gasPrice, nonce, etc)\n//         signTransaction (perform the signature)\n//         publishTransaction (publish signed tx to network)\n//\n\n\ninherits(HookedWalletSubprovider, Subprovider)\n\nfunction HookedWalletSubprovider(opts){\n  const self = this\n  // control flow\n  self.nonceLock = Semaphore(1)\n\n  // data lookup\n  if (opts.getAccounts) self.getAccounts = opts.getAccounts\n  // high level override\n  if (opts.processTransaction) self.processTransaction = opts.processTransaction\n  if (opts.processMessage) self.processMessage = opts.processMessage\n  if (opts.processPersonalMessage) self.processPersonalMessage = opts.processPersonalMessage\n  if (opts.processTypedMessage) self.processTypedMessage = opts.processTypedMessage\n  // approval hooks\n  self.approveTransaction = opts.approveTransaction || self.autoApprove\n  self.approveMessage = opts.approveMessage || self.autoApprove\n  self.approvePersonalMessage = opts.approvePersonalMessage || self.autoApprove\n  self.approveDecryptMessage = opts.approveDecryptMessage || self.autoApprove\n  self.approveEncryptionPublicKey = opts.approveEncryptionPublicKey || self.autoApprove\n  self.approveTypedMessage = opts.approveTypedMessage || self.autoApprove\n  // actually perform the signature\n  if (opts.signTransaction) self.signTransaction = opts.signTransaction  || mustProvideInConstructor('signTransaction')\n  if (opts.signMessage) self.signMessage = opts.signMessage  || mustProvideInConstructor('signMessage')\n  if (opts.signPersonalMessage) self.signPersonalMessage = opts.signPersonalMessage  || mustProvideInConstructor('signPersonalMessage')\n  if (opts.decryptMessage) self.decryptMessage = opts.decryptMessage  || mustProvideInConstructor('decryptMessage')\n  if (opts.encryptionPublicKey) self.encryptionPublicKey = opts.encryptionPublicKey  || mustProvideInConstructor('encryptionPublicKey')\n  if (opts.signTypedMessage) self.signTypedMessage = opts.signTypedMessage  || mustProvideInConstructor('signTypedMessage')\n  if (opts.recoverPersonalSignature) self.recoverPersonalSignature = opts.recoverPersonalSignature\n  // publish to network\n  if (opts.publishTransaction) self.publishTransaction = opts.publishTransaction\n  // gas options\n  self.estimateGas = opts.estimateGas || self.estimateGas\n  self.getGasPrice = opts.getGasPrice || self.getGasPrice\n}\n\nHookedWalletSubprovider.prototype.handleRequest = function(payload, next, end){\n  const self = this\n  self._parityRequests = {}\n  self._parityRequestCount = 0\n\n  // switch statement is not block scoped\n  // sp we cant repeat var declarations\n  let txParams, msgParams, extraParams\n  let message, address\n\n  switch(payload.method) {\n\n    case 'eth_coinbase':\n      // process normally\n      self.getAccounts(function(err, accounts){\n        if (err) return end(err)\n        let result = accounts[0] || null\n        end(null, result)\n      })\n      return\n\n    case 'eth_accounts':\n      // process normally\n      self.getAccounts(function(err, accounts){\n        if (err) return end(err)\n        end(null, accounts)\n      })\n      return\n\n    case 'eth_sendTransaction':\n      txParams = payload.params[0]\n      waterfall([\n        (cb) => self.validateTransaction(txParams, cb),\n        (cb) => self.processTransaction(txParams, cb),\n      ], end)\n      return\n\n    case 'eth_signTransaction':\n      txParams = payload.params[0]\n      waterfall([\n        (cb) => self.validateTransaction(txParams, cb),\n        (cb) => self.processSignTransaction(txParams, cb),\n      ], end)\n      return\n\n    case 'eth_sign':\n      // process normally\n      address = payload.params[0]\n      message = payload.params[1]\n      // non-standard \"extraParams\" to be appended to our \"msgParams\" obj\n      // good place for metadata\n      extraParams = payload.params[2] || {}\n      msgParams = extend(extraParams, {\n        from: address,\n        data: message,\n      })\n      waterfall([\n        (cb) => self.validateMessage(msgParams, cb),\n        (cb) => self.processMessage(msgParams, cb),\n      ], end)\n      return\n\n    case 'personal_sign':\n      return (function(){\n        // process normally\n        const first = payload.params[0]\n        const second = payload.params[1]\n\n        // We initially incorrectly ordered these parameters.\n        // To gracefully respect users who adopted this API early,\n        // we are currently gracefully recovering from the wrong param order\n        // when it is clearly identifiable.\n        //\n        // That means when the first param is definitely an address,\n        // and the second param is definitely not, but is hex.\n        if (resemblesData(second) && resemblesAddress(first)) {\n          let warning = `The eth_personalSign method requires params ordered `\n          warning += `[message, address]. This was previously handled incorrectly, `\n          warning += `and has been corrected automatically. `\n          warning += `Please switch this param order for smooth behavior in the future.`\n          console.warn(warning)\n\n          address = payload.params[0]\n          message = payload.params[1]\n        } else {\n          message = payload.params[0]\n          address = payload.params[1]\n        }\n\n        // non-standard \"extraParams\" to be appended to our \"msgParams\" obj\n        // good place for metadata\n        extraParams = payload.params[2] || {}\n        msgParams = extend(extraParams, {\n          from: address,\n          data: message,\n        })\n        waterfall([\n          (cb) => self.validatePersonalMessage(msgParams, cb),\n          (cb) => self.processPersonalMessage(msgParams, cb),\n        ], end)\n      })()\n\n    case 'eth_decryptMessage':\n      return (function(){\n        // process normally\n        const first = payload.params[0]\n        const second = payload.params[1]\n\n        // We initially incorrectly ordered these parameters.\n        // To gracefully respect users who adopted this API early,\n        // we are currently gracefully recovering from the wrong param order\n        // when it is clearly identifiable.\n        //\n        // That means when the first param is definitely an address,\n        // and the second param is definitely not, but is hex.\n        if (resemblesData(second) && resemblesAddress(first)) {\n          let warning = `The eth_decryptMessage method requires params ordered `\n          warning += `[message, address]. This was previously handled incorrectly, `\n          warning += `and has been corrected automatically. `\n          warning += `Please switch this param order for smooth behavior in the future.`\n          console.warn(warning)\n\n          address = payload.params[0]\n          message = payload.params[1]\n        } else {\n          message = payload.params[0]\n          address = payload.params[1]\n        }\n\n        // non-standard \"extraParams\" to be appended to our \"msgParams\" obj\n        // good place for metadata\n        extraParams = payload.params[2] || {}\n        msgParams = extend(extraParams, {\n          from: address,\n          data: message,\n        })\n        waterfall([\n          (cb) => self.validateDecryptMessage(msgParams, cb),\n          (cb) => self.processDecryptMessage(msgParams, cb),\n        ], end)\n      })()\n      \n    case 'encryption_public_key':\n      return (function(){\n        const address = payload.params[0]\n        \n        waterfall([\n          (cb) => self.validateEncryptionPublicKey(address, cb),\n          (cb) => self.processEncryptionPublicKey(address, cb),\n        ], end)\n      })()\n      \n    case 'personal_ecRecover':\n      return (function(){    \n        message = payload.params[0]\n        let signature = payload.params[1]\n        // non-standard \"extraParams\" to be appended to our \"msgParams\" obj\n        // good place for metadata\n        extraParams = payload.params[2] || {}\n        msgParams = extend(extraParams, {\n          sig: signature,\n          data: message,\n        })\n        self.recoverPersonalSignature(msgParams, end)\n      })()\n\n    case 'eth_signTypedData':\n    case 'eth_signTypedData_v3':\n    case 'eth_signTypedData_v4':\n      return (function(){ \n        // process normally\n      \n        const first = payload.params[0]\n        const second = payload.params[1]\n\n        if (resemblesAddress(first)) {\n          address = first\n          message = second\n        } else {\n          message = first\n          address = second\n        }\n\n        extraParams = payload.params[2] || {}\n        msgParams = extend(extraParams, {\n          from: address,\n          data: message,\n        })\n        waterfall([\n          (cb) => self.validateTypedMessage(msgParams, cb),\n          (cb) => self.processTypedMessage(msgParams, cb),\n        ], end)\n      })()\n\n    case 'parity_postTransaction':\n      txParams = payload.params[0]\n      self.parityPostTransaction(txParams, end)\n      return\n\n    case 'parity_postSign':\n      address = payload.params[0]\n      message = payload.params[1]\n      self.parityPostSign(address, message, end)\n      return\n\n    case 'parity_checkRequest':\n      return (function(){\n        const requestId = payload.params[0]\n        self.parityCheckRequest(requestId, end)\n      })()\n\n    case 'parity_defaultAccount':\n      self.getAccounts(function(err, accounts){\n        if (err) return end(err)\n        const account = accounts[0] || null\n        end(null, account)\n      })\n      return\n\n    default:\n      next()\n      return\n\n  }\n}\n\n//\n// data lookup\n//\n\nHookedWalletSubprovider.prototype.getAccounts = function(cb) {\n  cb(null, [])\n}\n\n\n//\n// \"process\" high level flow\n//\n\nHookedWalletSubprovider.prototype.processTransaction = function(txParams, cb) {\n  const self = this\n  waterfall([\n    (cb) => self.approveTransaction(txParams, cb),\n    (didApprove, cb) => self.checkApproval('transaction', didApprove, cb),\n    (cb) => self.finalizeAndSubmitTx(txParams, cb),\n  ], cb)\n}\n\n\nHookedWalletSubprovider.prototype.processSignTransaction = function(txParams, cb) {\n  const self = this\n  waterfall([\n    (cb) => self.approveTransaction(txParams, cb),\n    (didApprove, cb) => self.checkApproval('transaction', didApprove, cb),\n    (cb) => self.finalizeTx(txParams, cb),\n  ], cb)\n}\n\nHookedWalletSubprovider.prototype.processMessage = function(msgParams, cb) {\n  const self = this\n  waterfall([\n    (cb) => self.approveMessage(msgParams, cb),\n    (didApprove, cb) => self.checkApproval('message', didApprove, cb),\n    (cb) => self.signMessage(msgParams, cb),\n  ], cb)\n}\n\nHookedWalletSubprovider.prototype.processPersonalMessage = function(msgParams, cb) {\n  const self = this\n  waterfall([\n    (cb) => self.approvePersonalMessage(msgParams, cb),\n    (didApprove, cb) => self.checkApproval('message', didApprove, cb),\n    (cb) => self.signPersonalMessage(msgParams, cb),\n  ], cb)\n}\n\nHookedWalletSubprovider.prototype.processDecryptMessage = function(msgParams, cb) {\n  const self = this\n  waterfall([\n    (cb) => self.approveDecryptMessage(msgParams, cb),\n    (didApprove, cb) => self.checkApproval('decryptMessage', didApprove, cb),\n    (cb) => self.decryptMessage(msgParams, cb),\n  ], cb)\n}\n\nHookedWalletSubprovider.prototype.processEncryptionPublicKey = function(msgParams, cb) {\n  const self = this\n  waterfall([\n    (cb) => self.approveEncryptionPublicKey(msgParams, cb),\n    (didApprove, cb) => self.checkApproval('encryptionPublicKey', didApprove, cb),\n    (cb) => self.encryptionPublicKey(msgParams, cb),\n  ], cb)\n}\n\nHookedWalletSubprovider.prototype.processTypedMessage = function(msgParams, cb) {\n  const self = this\n  waterfall([\n    (cb) => self.approveTypedMessage(msgParams, cb),\n    (didApprove, cb) => self.checkApproval('message', didApprove, cb),\n    (cb) => self.signTypedMessage(msgParams, cb),\n  ], cb)\n}\n\n//\n// approval\n//\n\nHookedWalletSubprovider.prototype.autoApprove = function(txParams, cb) {\n  cb(null, true)\n}\n\nHookedWalletSubprovider.prototype.checkApproval = function(type, didApprove, cb) {\n  cb( didApprove ? null : new Error('User denied '+type+' signature.') )\n}\n\n//\n// parity\n//\n\nHookedWalletSubprovider.prototype.parityPostTransaction = function(txParams, cb) {\n  const self = this\n\n  // get next id\n  const count = self._parityRequestCount\n  const reqId = `0x${count.toString(16)}`\n  self._parityRequestCount++\n\n  self.emitPayload({\n    method: 'eth_sendTransaction',\n    params: [txParams],\n  }, function(error, res){\n    if (error) {\n      self._parityRequests[reqId] = { error }\n      return\n    }\n    const txHash = res.result\n    self._parityRequests[reqId] = txHash\n  })\n\n  cb(null, reqId)\n}\n\n\nHookedWalletSubprovider.prototype.parityPostSign = function(address, message, cb) {\n  const self = this\n\n  // get next id\n  const count = self._parityRequestCount\n  const reqId = `0x${count.toString(16)}`\n  self._parityRequestCount++\n\n  self.emitPayload({\n    method: 'eth_sign',\n    params: [address, message],\n  }, function(error, res){\n    if (error) {\n      self._parityRequests[reqId] = { error }\n      return\n    }\n    const result = res.result\n    self._parityRequests[reqId] = result\n  })\n\n  cb(null, reqId)\n}\n\nHookedWalletSubprovider.prototype.parityCheckRequest = function(reqId, cb) {\n  const self = this\n  const result = self._parityRequests[reqId] || null\n  // tx not handled yet\n  if (!result) return cb(null, null)\n  // tx was rejected (or other error)\n  if (result.error) return cb(result.error)\n  // tx sent\n  cb(null, result)\n}\n\n//\n// signature and recovery\n//\n\nHookedWalletSubprovider.prototype.recoverPersonalSignature = function(msgParams, cb) {\n  let senderHex\n  try {\n    senderHex = sigUtil.recoverPersonalSignature(msgParams)\n  } catch (err) {\n    return cb(err)\n  }\n  cb(null, senderHex)\n}\n\n//\n// validation\n//\n\nHookedWalletSubprovider.prototype.validateTransaction = function(txParams, cb){\n  const self = this\n  // shortcut: undefined sender is invalid\n  if (txParams.from === undefined) return cb(new Error(`Undefined address - from address required to sign transaction.`))\n  self.validateSender(txParams.from, function(err, senderIsValid){\n    if (err) return cb(err)\n    if (!senderIsValid) return cb(new Error(`Unknown address - unable to sign transaction for this address: \"${txParams.from}\"`))\n    cb()\n  })\n}\n\nHookedWalletSubprovider.prototype.validateMessage = function(msgParams, cb){\n  const self = this\n  if (msgParams.from === undefined) return cb(new Error(`Undefined address - from address required to sign message.`))\n  self.validateSender(msgParams.from, function(err, senderIsValid){\n    if (err) return cb(err)\n    if (!senderIsValid) return cb(new Error(`Unknown address - unable to sign message for this address: \"${msgParams.from}\"`))\n    cb()\n  })\n}\n\nHookedWalletSubprovider.prototype.validatePersonalMessage = function(msgParams, cb){\n  const self = this\n  if (msgParams.from === undefined) return cb(new Error(`Undefined address - from address required to sign personal message.`))\n  if (msgParams.data === undefined) return cb(new Error(`Undefined message - message required to sign personal message.`))\n  if (!isValidHex(msgParams.data)) return cb(new Error(`HookedWalletSubprovider - validateMessage - message was not encoded as hex.`))\n  self.validateSender(msgParams.from, function(err, senderIsValid){\n    if (err) return cb(err)\n    if (!senderIsValid) return cb(new Error(`Unknown address - unable to sign message for this address: \"${msgParams.from}\"`))\n    cb()\n  })\n}\n\nHookedWalletSubprovider.prototype.validateDecryptMessage = function(msgParams, cb){\n  const self = this\n  if (msgParams.from === undefined) return cb(new Error(`Undefined address - from address required to decrypt message.`))\n  if (msgParams.data === undefined) return cb(new Error(`Undefined message - message required to decrypt message.`))\n  if (!isValidHex(msgParams.data)) return cb(new Error(`HookedWalletSubprovider - validateDecryptMessage - message was not encoded as hex.`))\n  self.validateSender(msgParams.from, function(err, senderIsValid){\n    if (err) return cb(err)\n    if (!senderIsValid) return cb(new Error(`Unknown address - unable to decrypt message for this address: \"${msgParams.from}\"`))\n    cb()\n  })\n}\n\nHookedWalletSubprovider.prototype.validateEncryptionPublicKey = function(address, cb){\n  const self = this\n\n  self.validateSender(address, function(err, senderIsValid){\n    if (err) return cb(err)\n    if (!senderIsValid) return cb(new Error(`Unknown address - unable to obtain encryption public key for this address: \"${address}\"`))\n    cb()\n  })\n}\n\nHookedWalletSubprovider.prototype.validateTypedMessage = function(msgParams, cb){\n  if (msgParams.from === undefined) return cb(new Error(`Undefined address - from address required to sign typed data.`))\n  if (msgParams.data === undefined) return cb(new Error(`Undefined data - message required to sign typed data.`))\n  this.validateSender(msgParams.from, function(err, senderIsValid){\n    if (err) return cb(err)\n    if (!senderIsValid) return cb(new Error(`Unknown address - unable to sign message for this address: \"${msgParams.from}\"`))\n    cb()\n  })\n}\n\nHookedWalletSubprovider.prototype.validateSender = function(senderAddress, cb){\n  const self = this\n  // shortcut: undefined sender is invalid\n  if (!senderAddress) return cb(null, false)\n  self.getAccounts(function(err, accounts){\n    if (err) return cb(err)\n    const senderIsValid = (accounts.map(toLowerCase).indexOf(senderAddress.toLowerCase()) !== -1)\n    cb(null, senderIsValid)\n  })\n}\n\n//\n// tx helpers\n//\n\nHookedWalletSubprovider.prototype.finalizeAndSubmitTx = function(txParams, cb) {\n  const self = this\n  // can only allow one tx to pass through this flow at a time\n  // so we can atomically consume a nonce\n  self.nonceLock.take(function(){\n    waterfall([\n      self.fillInTxExtras.bind(self, txParams),\n      self.signTransaction.bind(self),\n      self.publishTransaction.bind(self),\n    ], function(err, txHash){\n      self.nonceLock.leave()\n      if (err) return cb(err)\n      cb(null, txHash)\n    })\n  })\n}\n\nHookedWalletSubprovider.prototype.finalizeTx = function(txParams, cb) {\n  const self = this\n  // can only allow one tx to pass through this flow at a time\n  // so we can atomically consume a nonce\n  self.nonceLock.take(function(){\n    waterfall([\n      self.fillInTxExtras.bind(self, txParams),\n      self.signTransaction.bind(self),\n    ], function(err, signedTx){\n      self.nonceLock.leave()\n      if (err) return cb(err)\n      cb(null, {raw: signedTx, tx: txParams})\n    })\n  })\n}\n\nHookedWalletSubprovider.prototype.publishTransaction = function(rawTx, cb) {\n  const self = this\n  self.emitPayload({\n    method: 'eth_sendRawTransaction',\n    params: [rawTx],\n  }, function(err, res){\n    if (err) return cb(err)\n    cb(null, res.result)\n  })\n}\n\nHookedWalletSubprovider.prototype.estimateGas = function(txParams, cb) {\n  const self = this\n  estimateGas(self.engine, txParams, cb)\n}\n\nHookedWalletSubprovider.prototype.getGasPrice = function(cb) {\n  const self = this\n  self.emitPayload({ method: 'eth_gasPrice', params: [] }, function (err, res) {\n    if (err) return cb(err)\n    cb(null, res.result)\n  })\n}\n\nHookedWalletSubprovider.prototype.fillInTxExtras = function(txParams, cb){\n  const self = this\n  const address = txParams.from\n  // console.log('fillInTxExtras - address:', address)\n\n  const tasks = {}\n\n  if (txParams.gasPrice === undefined) {\n    // console.log(\"need to get gasprice\")\n    tasks.gasPrice = self.getGasPrice.bind(self)\n  }\n\n  if (txParams.nonce === undefined) {\n    // console.log(\"need to get nonce\")\n    tasks.nonce = self.emitPayload.bind(self, { method: 'eth_getTransactionCount', params: [address, 'pending'] })\n  }\n\n  if (txParams.gas === undefined) {\n    // console.log(\"need to get gas\")\n    tasks.gas = self.estimateGas.bind(self, cloneTxParams(txParams))\n  }\n\n  parallel(tasks, function(err, taskResults) {\n    if (err) return cb(err)\n\n    const result = {}\n    if (taskResults.gasPrice) result.gasPrice = taskResults.gasPrice\n    if (taskResults.nonce) result.nonce = taskResults.nonce.result\n    if (taskResults.gas) result.gas = taskResults.gas\n\n    cb(null, extend(txParams, result))\n  })\n}\n\n// util\n\n// we use this to clean any custom params from the txParams\nfunction cloneTxParams(txParams){\n  return {\n    from: txParams.from,\n    to: txParams.to,\n    value: txParams.value,\n    data: txParams.data,\n    gas: txParams.gas,\n    gasPrice: txParams.gasPrice,\n    nonce: txParams.nonce,\n  }\n}\n\nfunction toLowerCase(string){\n  return string.toLowerCase()\n}\n\nfunction resemblesAddress (string) {\n  const fixed = ethUtil.addHexPrefix(string)\n  const isValid = ethUtil.isValidAddress(fixed)\n  return isValid\n}\n\n// Returns true if resembles hex data\n// but definitely not a valid address.\nfunction resemblesData (string) {\n  const fixed = ethUtil.addHexPrefix(string)\n  const isValidAddress = ethUtil.isValidAddress(fixed)\n  return !isValidAddress && isValidHex(string)\n}\n\nfunction isValidHex(data) {\n  const isString = typeof data === 'string'\n  if (!isString) return false\n  const isHexPrefixed = data.slice(0,2) === '0x'\n  if (!isHexPrefixed) return false\n  const nonPrefixed = data.slice(2)\n  const isValid = nonPrefixed.match(hexRegex)\n  return isValid\n}\n\nfunction mustProvideInConstructor(methodName) {\n  return function(params, cb) {\n    cb(new Error('ProviderEngine - HookedWalletSubprovider - Must provide \"' + methodName + '\" fn in constructor options'))\n  }\n}\n","const createPayload = require('../util/create-payload.js')\n\nmodule.exports = SubProvider\n\n// this is the base class for a subprovider -- mostly helpers\n\n\nfunction SubProvider() {\n\n}\n\nSubProvider.prototype.setEngine = function(engine) {\n  const self = this\n  if (self.engine) return\n  self.engine = engine\n  engine.on('block', function(block) {\n    self.currentBlock = block\n  })\n\n  engine.on('start', function () {\n    self.start()\n  })\n\n  engine.on('stop', function () {\n    self.stop()\n  })\n}\n\nSubProvider.prototype.handleRequest = function(payload, next, end) {\n  throw new Error('Subproviders should override `handleRequest`.')\n}\n\nSubProvider.prototype.emitPayload = function(payload, cb){\n  const self = this\n  self.engine.sendAsync(createPayload(payload), cb)\n}\n\n// dummies for overriding\n\nSubProvider.prototype.stop = function () {}\n\nSubProvider.prototype.start = function () {}\n","const createPayload = require('./create-payload.js')\n\nmodule.exports = estimateGas\n\n/*\n\nThis is a work around for https://github.com/ethereum/go-ethereum/issues/2577\n\n*/\n\n\nfunction estimateGas(provider, txParams, cb) {\n  provider.sendAsync(createPayload({\n    method: 'eth_estimateGas',\n    params: [txParams]\n  }), function(err, res){\n    if (err) {\n      // handle simple value transfer case\n      if (err.message === 'no contract code at given address') {\n        return cb(null, '0xcf08')\n      } else {\n        return cb(err)        \n      }\n    }\n    cb(null, res.result)\n  })\n}","const ProviderSubprovider = require('./json-rpc-engine-middleware')\nconst createFilterMiddleware = require('eth-json-rpc-filters')\n\nclass SubscriptionsSubprovider extends ProviderSubprovider {\n  constructor() {\n    super(({ blockTracker, provider, engine }) => {\n      return createFilterMiddleware({ blockTracker, provider })\n    })\n  }\n}\n\nmodule.exports = SubscriptionsSubprovider\n","const EventEmitter = require('events').EventEmitter\nconst inherits = require('util').inherits\nconst ethUtil = require('ethereumjs-util')\nconst EthBlockTracker = require('eth-block-tracker')\nconst map = require('async/map')\nconst eachSeries = require('async/eachSeries')\nconst Stoplight = require('./util/stoplight.js')\nconst cacheUtils = require('./util/rpc-cache-utils.js')\nconst createPayload = require('./util/create-payload.js')\nconst noop = function(){}\n\nmodule.exports = Web3ProviderEngine\n\n\ninherits(Web3ProviderEngine, EventEmitter)\n\nfunction Web3ProviderEngine(opts) {\n  const self = this\n  EventEmitter.call(self)\n  self.setMaxListeners(30)\n  // parse options\n  opts = opts || {}\n\n  // block polling\n  const directProvider = { sendAsync: self._handleAsync.bind(self) }\n  const blockTrackerProvider = opts.blockTrackerProvider || directProvider\n  self._blockTracker = opts.blockTracker || new EthBlockTracker({\n    provider: blockTrackerProvider,\n    pollingInterval: opts.pollingInterval || 4000,\n    setSkipCacheFlag: true,\n  })\n\n  // set initialization blocker\n  self._ready = new Stoplight()\n\n  // local state\n  self.currentBlock = null\n  self._providers = []\n}\n\n// public\n\nWeb3ProviderEngine.prototype.start = function(cb = noop){\n  const self = this\n\n  // trigger start\n  self._ready.go()\n\n  // on new block, request block body and emit as events\n  self._blockTracker.on('latest', (blockNumber) => {\n    // get block body\n    self._getBlockByNumberWithRetry(blockNumber, (err, block) => {\n      if (err) {\n        this.emit('error', err)\n        return\n      }\n      if (!block) {\n        console.log(block)\n        this.emit('error', new Error(\"Could not find block\"))\n        return\n      }\n      const bufferBlock = toBufferBlock(block)\n      // set current + emit \"block\" event\n      self._setCurrentBlock(bufferBlock)\n      // emit other events\n      self.emit('rawBlock', block)\n      self.emit('latest', block)\n    })\n  })\n\n  // forward other events\n  self._blockTracker.on('sync', self.emit.bind(self, 'sync'))\n  self._blockTracker.on('error', self.emit.bind(self, 'error'))\n\n  // update state\n  self._running = true\n  // signal that we started\n  self.emit('start')\n}\n\nWeb3ProviderEngine.prototype.stop = function(){\n  const self = this\n  // stop block polling by removing event listeners\n  self._blockTracker.removeAllListeners()\n  // update state\n  self._running = false\n  // signal that we stopped\n  self.emit('stop')\n}\n\nWeb3ProviderEngine.prototype.isRunning = function(){\n  const self = this\n  return self._running\n}\n\nWeb3ProviderEngine.prototype.addProvider = function(source, index){\n  const self = this\n  if (typeof index === 'number') {\n    self._providers.splice(index, 0, source)\n  } else {\n    self._providers.push(source)\n  }\n  source.setEngine(this)\n}\n\nWeb3ProviderEngine.prototype.removeProvider = function(source){\n  const self = this\n  const index = self._providers.indexOf(source)\n  if (index < 0) throw new Error('Provider not found.')\n  self._providers.splice(index, 1)\n}\n\nWeb3ProviderEngine.prototype.send = function(payload){\n  throw new Error('Web3ProviderEngine does not support synchronous requests.')\n}\n\nWeb3ProviderEngine.prototype.sendAsync = function(payload, cb){\n  const self = this\n  self._ready.await(function(){\n\n    if (Array.isArray(payload)) {\n      // handle batch\n      map(payload, self._handleAsync.bind(self), cb)\n    } else {\n      // handle single\n      self._handleAsync(payload, cb)\n    }\n\n  })\n}\n\n// private\n\nWeb3ProviderEngine.prototype._getBlockByNumberWithRetry = function(blockNumber, cb) {\n  const self = this\n\n  let retriesRemaining = 5\n\n  attemptRequest()\n  return\n\n  function attemptRequest () {\n    self._getBlockByNumber(blockNumber, afterRequest)\n  }\n\n  function afterRequest (err, block) {\n    // anomalous error occurred\n    if (err) return cb(err)\n    // block not ready yet\n    if (!block) {\n      if (retriesRemaining > 0) {\n        // wait 1s then try again\n        retriesRemaining--\n        setTimeout(function () {\n          attemptRequest()\n        }, 1000)\n        return\n      } else {\n        // give up, return a null block\n        cb(null, null)\n        return\n      }\n    }\n    // otherwise return result\n    cb(null, block)\n    return\n  }\n}\n\n\nWeb3ProviderEngine.prototype._getBlockByNumber = function(blockNumber, cb) {\n  const req = createPayload({ method: 'eth_getBlockByNumber', params: [blockNumber, false], skipCache: true })\n  this._handleAsync(req, (err, res) => {\n    if (err) return cb(err)\n    return cb(null, res.result)\n  })\n}\n\nWeb3ProviderEngine.prototype._handleAsync = function(payload, finished) {\n  var self = this\n  var currentProvider = -1\n  var result = null\n  var error = null\n\n  var stack = []\n\n  next()\n\n  function next(after) {\n    currentProvider += 1\n    stack.unshift(after)\n\n    // Bubbled down as far as we could go, and the request wasn't\n    // handled. Return an error.\n    if (currentProvider >= self._providers.length) {\n      end(new Error('Request for method \"' + payload.method + '\" not handled by any subprovider. Please check your subprovider configuration to ensure this method is handled.'))\n    } else {\n      try {\n        var provider = self._providers[currentProvider]\n        provider.handleRequest(payload, next, end)\n      } catch (e) {\n        end(e)\n      }\n    }\n  }\n\n  function end(_error, _result) {\n    error = _error\n    result = _result\n\n    eachSeries(stack, function(fn, callback) {\n\n      if (fn) {\n        fn(error, result, callback)\n      } else {\n        callback()\n      }\n    }, function() {\n\n      var resultObj = {\n        id: payload.id,\n        jsonrpc: payload.jsonrpc,\n        result: result\n      }\n\n      if (error != null) {\n        resultObj.error = {\n          message: error.stack || error.message || error,\n          code: -32000\n        }\n        // respond with both error formats\n        finished(error, resultObj)\n      } else {\n        finished(null, resultObj)\n      }\n    })\n  }\n}\n\n//\n// from remote-data\n//\n\nWeb3ProviderEngine.prototype._setCurrentBlock = function(block){\n  const self = this\n  self.currentBlock = block\n  self.emit('block', block)\n}\n\n// util\n\nfunction toBufferBlock (jsonBlock) {\n  return {\n    number:           ethUtil.toBuffer(jsonBlock.number),\n    hash:             ethUtil.toBuffer(jsonBlock.hash),\n    parentHash:       ethUtil.toBuffer(jsonBlock.parentHash),\n    nonce:            ethUtil.toBuffer(jsonBlock.nonce),\n    mixHash:          ethUtil.toBuffer(jsonBlock.mixHash),\n    sha3Uncles:       ethUtil.toBuffer(jsonBlock.sha3Uncles),\n    logsBloom:        ethUtil.toBuffer(jsonBlock.logsBloom),\n    transactionsRoot: ethUtil.toBuffer(jsonBlock.transactionsRoot),\n    stateRoot:        ethUtil.toBuffer(jsonBlock.stateRoot),\n    receiptsRoot:     ethUtil.toBuffer(jsonBlock.receiptRoot || jsonBlock.receiptsRoot),\n    miner:            ethUtil.toBuffer(jsonBlock.miner),\n    difficulty:       ethUtil.toBuffer(jsonBlock.difficulty),\n    totalDifficulty:  ethUtil.toBuffer(jsonBlock.totalDifficulty),\n    size:             ethUtil.toBuffer(jsonBlock.size),\n    extraData:        ethUtil.toBuffer(jsonBlock.extraData),\n    gasLimit:         ethUtil.toBuffer(jsonBlock.gasLimit),\n    gasUsed:          ethUtil.toBuffer(jsonBlock.gasUsed),\n    timestamp:        ethUtil.toBuffer(jsonBlock.timestamp),\n    transactions:     jsonBlock.transactions,\n  }\n}\n","const stringify = require('json-stable-stringify')\n\nmodule.exports = {\n  cacheIdentifierForPayload: cacheIdentifierForPayload,\n  canCache: canCache,\n  blockTagForPayload: blockTagForPayload,\n  paramsWithoutBlockTag: paramsWithoutBlockTag,\n  blockTagParamIndex: blockTagParamIndex,\n  cacheTypeForPayload: cacheTypeForPayload,\n}\n\nfunction cacheIdentifierForPayload(payload, opts = {}){\n  if (!canCache(payload)) return null\n  const { includeBlockRef } = opts\n  const params = includeBlockRef ? payload.params : paramsWithoutBlockTag(payload)\n  return payload.method + ':' + stringify(params)\n}\n\nfunction canCache(payload){\n  return cacheTypeForPayload(payload) !== 'never'\n}\n\nfunction blockTagForPayload(payload){\n  var index = blockTagParamIndex(payload);\n\n  // Block tag param not passed.\n  if (index >= payload.params.length) {\n    return null;\n  }\n\n  return payload.params[index];\n}\n\nfunction paramsWithoutBlockTag(payload){\n  var index = blockTagParamIndex(payload);\n\n  // Block tag param not passed.\n  if (index >= payload.params.length) {\n    return payload.params;\n  }\n\n  // eth_getBlockByNumber has the block tag first, then the optional includeTx? param\n  if (payload.method === 'eth_getBlockByNumber') {\n    return payload.params.slice(1);\n  }\n\n  return payload.params.slice(0,index);\n}\n\nfunction blockTagParamIndex(payload){\n  switch(payload.method) {\n    // blockTag is third param\n    case 'eth_getStorageAt':\n      return 2\n    // blockTag is second param\n    case 'eth_getBalance':\n    case 'eth_getCode':\n    case 'eth_getTransactionCount':\n    case 'eth_call':\n    case 'eth_estimateGas':\n      return 1\n    // blockTag is first param\n    case 'eth_getBlockByNumber':\n      return 0\n    // there is no blockTag\n    default:\n      return undefined\n  }\n}\n\nfunction cacheTypeForPayload(payload) {\n  switch (payload.method) {\n    // cache permanently\n    case 'web3_clientVersion':\n    case 'web3_sha3':\n    case 'eth_protocolVersion':\n    case 'eth_getBlockTransactionCountByHash':\n    case 'eth_getUncleCountByBlockHash':\n    case 'eth_getCode':\n    case 'eth_getBlockByHash':\n    case 'eth_getTransactionByHash':\n    case 'eth_getTransactionByBlockHashAndIndex':\n    case 'eth_getTransactionReceipt':\n    case 'eth_getUncleByBlockHashAndIndex':\n    case 'eth_getCompilers':\n    case 'eth_compileLLL':\n    case 'eth_compileSolidity':\n    case 'eth_compileSerpent':\n    case 'shh_version':\n      return 'perma'\n\n    // cache until fork\n    case 'eth_getBlockByNumber':\n    case 'eth_getBlockTransactionCountByNumber':\n    case 'eth_getUncleCountByBlockNumber':\n    case 'eth_getTransactionByBlockNumberAndIndex':\n    case 'eth_getUncleByBlockNumberAndIndex':\n      return 'fork'\n\n    // cache for block\n    case 'eth_gasPrice':\n    case 'eth_getBalance':\n    case 'eth_getStorageAt':\n    case 'eth_getTransactionCount':\n    case 'eth_call':\n    case 'eth_estimateGas':\n    case 'eth_getFilterLogs':\n    case 'eth_getLogs':\n    case 'eth_blockNumber':\n      return 'block'\n\n    // never cache\n    case 'net_version':\n    case 'net_peerCount':\n    case 'net_listening':\n    case 'eth_syncing':\n    case 'eth_sign':\n    case 'eth_coinbase':\n    case 'eth_mining':\n    case 'eth_hashrate':\n    case 'eth_accounts':\n    case 'eth_sendTransaction':\n    case 'eth_sendRawTransaction':\n    case 'eth_newFilter':\n    case 'eth_newBlockFilter':\n    case 'eth_newPendingTransactionFilter':\n    case 'eth_uninstallFilter':\n    case 'eth_getFilterChanges':\n    case 'eth_getWork':\n    case 'eth_submitWork':\n    case 'eth_submitHashrate':\n    case 'db_putString':\n    case 'db_getString':\n    case 'db_putHex':\n    case 'db_getHex':\n    case 'shh_post':\n    case 'shh_newIdentity':\n    case 'shh_hasIdentity':\n    case 'shh_newGroup':\n    case 'shh_addToGroup':\n    case 'shh_newFilter':\n    case 'shh_uninstallFilter':\n    case 'shh_getFilterChanges':\n    case 'shh_getMessages':\n      return 'never'\n  }\n}\n","const Subprovider = require('./subprovider.js')\n\n// wraps a json-rpc-engine middleware in a subprovider interface\n\nclass JsonRpcEngineMiddlewareSubprovider extends Subprovider {\n\n  // take a constructorFn to call once we have a reference to the engine\n  constructor (constructorFn) {\n    super()\n    if (!constructorFn) throw new Error('JsonRpcEngineMiddlewareSubprovider - no constructorFn specified')\n    this._constructorFn = constructorFn\n  }\n\n  // this is called once the subprovider has been added to the provider engine\n  setEngine (engine) {\n    if (this.middleware) throw new Error('JsonRpcEngineMiddlewareSubprovider - subprovider added to engine twice')\n    const blockTracker = engine._blockTracker\n    const middleware = this._constructorFn({ engine, provider: engine, blockTracker })\n    if (!middleware) throw new Error('JsonRpcEngineMiddlewareSubprovider - _constructorFn did not return middleware')\n    if (typeof middleware !== 'function') throw new Error('JsonRpcEngineMiddlewareSubprovider - specified middleware is not a function')\n    this.middleware = middleware\n  }\n\n  handleRequest (req, provEngNext, provEngEnd) {\n    const res = { id: req.id }\n    this.middleware(req, res, middlewareNext, middlewareEnd)\n\n    function middlewareNext (handler) {\n      provEngNext((err, result, cb) => {\n        // update response object with result or error\n        if (err) {\n          delete res.result\n          res.error = { message: err.message || err }\n        } else {\n          res.result = result\n        }\n        // call middleware's next handler (even if error)\n        if (handler) {\n          handler(cb)\n        } else {\n          cb()\n        }\n      })\n    }\n\n    function middlewareEnd (err) {\n      if (err) return provEngEnd(err)\n      provEngEnd(null, res.result)\n    }\n  }\n\n}\n\nmodule.exports = JsonRpcEngineMiddlewareSubprovider\n","module.exports = createRandomId\n\n\nfunction createRandomId () {\n  // random id\n  return Math.floor(Number.MAX_SAFE_INTEGER * Math.random())\n}","const getRandomId = require('./random-id.js')\nconst extend = require('xtend')\n\nmodule.exports = createPayload\n\n\nfunction createPayload(data){\n  return extend({\n    // defaults\n    id: getRandomId(),\n    jsonrpc: '2.0',\n    params: [],\n    // user-specified\n  }, data)\n}\n"]}